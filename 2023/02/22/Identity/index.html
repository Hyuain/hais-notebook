<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/hais-notebook/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/hais-notebook/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/hais-notebook/images/favicon-16x16.png">
  <link rel="mask-icon" href="/hais-notebook/images/safari-pinned-tab.svg" color="#222">

<link rel="stylesheet" href="/hais-notebook/css/main.css">

<link rel="stylesheet" href="https://fonts.font.im/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/hais-notebook/lib/@fortawesome/fontawesome-free/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"hyuain.github.io","root":"/hais-notebook/","images":"/hais-notebook/images","scheme":"Gemini","darkmode":false,"version":"8.14.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac","show_result":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/hais-notebook/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/hais-notebook/js/config.js"></script>

    <meta name="description" content="From Auth0 Docs. Glossary">
<meta property="og:type" content="article">
<meta property="og:title" content="Identity &amp; Auth0">
<meta property="og:url" content="https://hyuain.github.io/hais-notebook/2023/02/22/Identity/index.html">
<meta property="og:site_name" content="Hais Notebook">
<meta property="og:description" content="From Auth0 Docs. Glossary">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hais-note-pics-1301462215.cos.ap-chengdu.myqcloud.com/Client_Credentials_flow.png">
<meta property="og:image" content="https://hais-note-pics-1301462215.cos.ap-chengdu.myqcloud.com/auth-sequence-auth-code.png">
<meta property="og:image" content="https://hais-note-pics-1301462215.cos.ap-chengdu.myqcloud.com/ROP_Grant.png">
<meta property="og:image" content="https://hais-note-pics-1301462215.cos.ap-chengdu.myqcloud.com/auth-sequence-auth-code-pkce.png">
<meta property="og:image" content="https://hais-note-pics-1301462215.cos.ap-chengdu.myqcloud.com/auth-sequence-implicit-form-post.png">
<meta property="og:image" content="https://hais-note-pics-1301462215.cos.ap-chengdu.myqcloud.com/auth-sequence-device-auth.png">
<meta property="article:published_time" content="2023-02-22T15:57:10.000Z">
<meta property="article:modified_time" content="2023-02-22T15:57:10.000Z">
<meta property="article:author" content="Harvey Zhang">
<meta property="article:tag" content="Notebook">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hais-note-pics-1301462215.cos.ap-chengdu.myqcloud.com/Client_Credentials_flow.png">


<link rel="canonical" href="https://hyuain.github.io/hais-notebook/2023/02/22/Identity/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://hyuain.github.io/hais-notebook/2023/02/22/Identity/","path":"2023/02/22/Identity/","title":"Identity & Auth0"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Identity & Auth0 | Hais Notebook</title>
  






  <script async defer data-website-id="" src=""></script>

  <script defer data-domain="" src=""></script>

  <noscript>
    <link rel="stylesheet" href="/hais-notebook/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/hais-notebook/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hais Notebook</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/hais-notebook/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/hais-notebook/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/hais-notebook/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/hais-notebook/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#identity-fundamentals"><span class="nav-number">1.</span> <span class="nav-text">Identity Fundamentals</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#basic-concepts"><span class="nav-number">1.1.</span> <span class="nav-text">Basic Concepts</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#authentication-authorization"><span class="nav-number">1.1.1.</span> <span class="nav-text">Authentication &amp; Authorization</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#identity-providers"><span class="nav-number">1.1.2.</span> <span class="nav-text">Identity Providers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#authentication-factors"><span class="nav-number">1.1.3.</span> <span class="nav-text">Authentication Factors</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#protocols"><span class="nav-number">1.2.</span> <span class="nav-text">Protocols</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#oauth-2.0-protocol"><span class="nav-number">1.2.1.</span> <span class="nav-text">OAuth 2.0 Protocol</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#grant-types"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">Grant Types</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#client-credentials-flow"><span class="nav-number">1.2.1.1.1.</span> <span class="nav-text">Client Credentials Flow</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#authorization-code-flow"><span class="nav-number">1.2.1.1.2.</span> <span class="nav-text">Authorization Code Flow</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#resource-owner-password-flow"><span class="nav-number">1.2.1.1.3.</span> <span class="nav-text">Resource Owner Password Flow</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#authorization-code-flow-with-proof-key-for-code-exchange-pkce"><span class="nav-number">1.2.1.1.4.</span> <span class="nav-text">Authorization Code Flow with Proof Key for Code Exchange (PKCE)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#implicit-flow-with-form-post"><span class="nav-number">1.2.1.1.5.</span> <span class="nav-text">Implicit Flow with Form Post</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#device-authorization-flow"><span class="nav-number">1.2.1.1.6.</span> <span class="nav-text">Device Authorization Flow</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#endpoints"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">Endpoints</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#authorization-endpoint"><span class="nav-number">1.2.1.2.1.</span> <span class="nav-text">Authorization Endpoint</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#token-endpoint"><span class="nav-number">1.2.1.2.2.</span> <span class="nav-text">Token Endpoint</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#state-parameters"><span class="nav-number">1.2.1.3.</span> <span class="nav-text">State Parameters</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#open-id-connect-oidc-protocol"><span class="nav-number">1.2.2.</span> <span class="nav-text">Open ID Connect (OIDC) Protocol</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#security-assertion-markup-language-saml"><span class="nav-number">1.2.3.</span> <span class="nav-text">Security Assertion Markup Language (SAML)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-services-federation-ws-fed"><span class="nav-number">1.2.4.</span> <span class="nav-text">Web Services Federation (WS-Fed)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#tokens"><span class="nav-number">1.3.</span> <span class="nav-text">Tokens</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#json-web-tokens-jwts"><span class="nav-number">1.3.1.</span> <span class="nav-text">JSON Web Tokens (JWTs)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#introduction"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">Introduction</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#benefits"><span class="nav-number">1.3.1.1.1.</span> <span class="nav-text">Benefits</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#use"><span class="nav-number">1.3.1.1.2.</span> <span class="nav-text">Use</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#structure"><span class="nav-number">1.3.1.2.</span> <span class="nav-text">Structure</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#jose-header"><span class="nav-number">1.3.1.2.1.</span> <span class="nav-text">JOSE Header</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#jws-payload"><span class="nav-number">1.3.1.2.2.</span> <span class="nav-text">JWS Payload</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#jws-signature"><span class="nav-number">1.3.1.2.3.</span> <span class="nav-text">JWS Signature</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#claims"><span class="nav-number">1.3.1.3.</span> <span class="nav-text">Claims</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#registered-claims"><span class="nav-number">1.3.1.3.1.</span> <span class="nav-text">Registered Claims</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#custom-claims"><span class="nav-number">1.3.1.3.2.</span> <span class="nav-text">Custom Claims</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#public-claims"><span class="nav-number">1.3.1.3.2.1.</span> <span class="nav-text">Public Claims</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#private-claims"><span class="nav-number">1.3.1.3.2.2.</span> <span class="nav-text">Private Claims</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#signing-algorithms"><span class="nav-number">1.3.1.4.</span> <span class="nav-text">Signing Algorithms</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#id-tokens"><span class="nav-number">1.3.2.</span> <span class="nav-text">ID Tokens</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#validate-id-tokens"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">Validate ID Tokens</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#access-tokens"><span class="nav-number">1.3.3.</span> <span class="nav-text">Access Tokens</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#validate-access-tokens"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">Validate Access Tokens</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#refresh-tokens"><span class="nav-number">1.3.4.</span> <span class="nav-text">Refresh Tokens</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#token-best-practices"><span class="nav-number">1.3.5.</span> <span class="nav-text">Token Best Practices</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#basics-to-keep-in-mind"><span class="nav-number">1.3.5.1.</span> <span class="nav-text">Basics to Keep in Mind</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#auth0"><span class="nav-number">2.</span> <span class="nav-text">Auth0</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#authenticate"><span class="nav-number">2.1.</span> <span class="nav-text">Authenticate</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Harvey Zhang</p>
  <div class="site-description" itemprop="description">海鲜酱的笔记本</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/hais-notebook/archives/">
          <span class="site-state-item-count">41</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/hais-notebook/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hyuain.github.io/hais-notebook/2023/02/22/Identity/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/hais-notebook/images/avatar.gif">
      <meta itemprop="name" content="Harvey Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hais Notebook">
      <meta itemprop="description" content="海鲜酱的笔记本">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Identity & Auth0 | Hais Notebook">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Identity & Auth0
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-02-22 15:57:10" itemprop="dateCreated datePublished" datetime="2023-02-22T15:57:10+00:00">2023-02-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/hais-notebook/categories/%E5%85%A8%E6%A0%88/" itemprop="url" rel="index"><span itemprop="name">全栈</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>From <a target="_blank" rel="noopener" href="https://auth0.com/docs/get-started/identity-fundamentals">Auth0 Docs</a>. <a target="_blank" rel="noopener" href="https://auth0.com/docs/glossary">Glossary</a></p>
<span id="more"></span>
<h1 id="identity-fundamentals">Identity Fundamentals</h1>
<p><strong>Identity and Access Management (IAM)</strong> provides control over <strong>user validation</strong> and <strong>resource access</strong>.</p>
<p>IAM ensures that the <strong>right people</strong> access the <strong>right digital resource</strong> at the <strong>right time</strong> and for the <strong>right reason</strong>.</p>
<p>IAM usually combines these capabilities:</p>
<ul>
<li>Seamless signup and login experiences</li>
<li>Multiple source of user identities</li>
<li>Multi-factor authentication (MFA)</li>
<li>Step-up authentication</li>
<li>Attack protection</li>
<li>Role-based access control (RBAC)</li>
</ul>
<h2 id="basic-concepts">Basic Concepts</h2>
<ul>
<li><strong>Digital resource</strong>: Combination of applications and data, e.g. web applications, APIs, platforms, devices, or databases.</li>
<li>The core of IAM is <strong>identity</strong>.
<ul>
<li>In IAM, a <strong>user account</strong> is a <strong>digital identity</strong> (Set of attributes that define a particular user).</li>
<li>User account can also represent non-humans, such as software, IoT devices, or robotics.</li>
</ul></li>
</ul>
<h3 id="authentication-authorization">Authentication &amp; Authorization</h3>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Authentication</strong></th>
<th style="text-align: left;"><strong>Authorization</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Determines whether users are who they claim to be</td>
<td style="text-align: left;">Determines what users can and cannot access</td>
</tr>
<tr class="even">
<td style="text-align: left;">Challenges the user to validate credentials (for example, through passwords, answers to security questions, or facial recognition)</td>
<td style="text-align: left;">Verifies whether access is allowed through policies and rules</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Usually done before authorization</td>
<td style="text-align: left;">Usually done after successful authentication</td>
</tr>
<tr class="even">
<td style="text-align: left;">Generally, transmits info through an ID Token</td>
<td style="text-align: left;">Generally, transmits info through an Access Token</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Generally governed by the OpenID Connect (OIDC) protocol</td>
<td style="text-align: left;">Generally governed by the OAuth 2.0 framework</td>
</tr>
<tr class="even">
<td style="text-align: left;">Example: Employees in a company are required to authenticate through the network before accessing their company email</td>
<td style="text-align: left;">Example: After an employee successfully authenticates, the system determines what information the employees are allowed to access</td>
</tr>
</tbody>
</table>
<h3 id="identity-providers">Identity Providers</h3>
<p>An identity provider creates, maintains, and manages identity information, and can provide authentication services to other applications. E.g., Google Account, Facebook, LinkedIn, Microsoft Active Directory and Swedish BankID.</p>
<p>Identity Providers don't share your authentication credentials with the app that rely on them.</p>
<h3 id="authentication-factors">Authentication Factors</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Factor type</th>
<th style="text-align: left;">Examples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Knowledge (something you know)</td>
<td style="text-align: left;">Pin, password</td>
</tr>
<tr class="even">
<td style="text-align: left;">Possession (something you have)</td>
<td style="text-align: left;">Mobile phone, encryption key device</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inherence (something you are)</td>
<td style="text-align: left;">Fingerprint, facial recognition, iris scan</td>
</tr>
</tbody>
</table>
<h2 id="protocols">Protocols</h2>
<p>Some specifications and protocols that provide guidance on how to:</p>
<ul>
<li>Design IAM systems to manage identity</li>
<li>Move personal data securely</li>
<li>Decide who can access resources</li>
</ul>
<p>These IAM industry standards are considered to the most secure, reliable, and practical to implement:</p>
<h3 id="oauth-2.0-protocol">OAuth 2.0 Protocol</h3>
<p>Lets an app access resources hosted by other web apps on behalf of a user without ever sharing the user's credentials.</p>
<p>It allows third-party developers to rely on large social platforms like Facebook, Google and Twitter for login.</p>
<ul>
<li><strong>Resource Owner</strong>: Entity that can grant access to a protected resource. (<strong>end-user</strong>).</li>
<li><strong>Client</strong>: <strong>Application</strong> requesting access to protected resource on behalf of the <strong>Resource Owner</strong>.</li>
<li><strong>Resource Server</strong>: Server hosting the protected resource. (<strong>the API</strong> you want to access).</li>
<li><strong>Authorization Server</strong>: Server that authenticates the <strong>Resource Owner</strong> and issues <strong>Access Tokens</strong> after getting proper authorization (e.g. Auth0).</li>
<li><strong>User Agent</strong>: Agent used by <strong>Resource Owner</strong> to interact with the Client (e.g. a browser or a native application).</li>
</ul>
<h4 id="grant-types">Grant Types</h4>
<p>OAuth 2.0 defines flows to get an access token, these flows are called grant types.</p>
<h5 id="client-credentials-flow">Client Credentials Flow</h5>
<ul>
<li>Machine-to-machine (M2M) applications (CLIs, daemons, services running on back-end).</li>
<li>No username &amp; password.</li>
<li>Pass <strong>Client ID</strong> and <strong>Client Secret</strong> to authenticate and get a token.</li>
</ul>
<figure>
<img src="https://hais-note-pics-1301462215.cos.ap-chengdu.myqcloud.com/Client_Credentials_flow.png" alt="Client Credentials Flow" /><figcaption aria-hidden="true">Client Credentials Flow</figcaption>
</figure>
<h5 id="authorization-code-flow">Authorization Code Flow</h5>
<ul>
<li>Server-side web applications</li>
<li>Exchange an <strong>Authorization Code</strong> for a token, also pass along <strong>Client Secret</strong></li>
</ul>
<figure>
<img src="https://hais-note-pics-1301462215.cos.ap-chengdu.myqcloud.com/auth-sequence-auth-code.png" alt="Authorization Code Flow" /><figcaption aria-hidden="true">Authorization Code Flow</figcaption>
</figure>
<p>In short:</p>
<ol type="1">
<li><strong>The user</strong> click login on the <strong>web app</strong>, and the web app request authorization from <strong>Authorization Server</strong>.</li>
<li><strong>Authorization Server</strong> asks the <strong>user</strong> for authorization and get <strong>Authorization Code</strong>. And redirect to the <strong>web app</strong>.</li>
<li>Server-side web application gets the <strong>Authorization Code</strong>, and send it to <strong>Authorization Server</strong> with <strong>Client Secret</strong>, to get the token.</li>
</ol>
<h5 id="resource-owner-password-flow">Resource Owner Password Flow</h5>
<ul>
<li>Must not be used by third-party clients. Only highly-trusted applications can use this flow.</li>
<li>Requests users provide credentials (username and password), typically using an interactive form.</li>
<li>Even if the application is highly-trusted, this flow should only be used when redirect-based flows (like Authorization Code Flow) cannot be used.</li>
</ul>
<figure>
<img src="https://hais-note-pics-1301462215.cos.ap-chengdu.myqcloud.com/ROP_Grant.png" alt="Resource Owner Password" /><figcaption aria-hidden="true">Resource Owner Password</figcaption>
</figure>
<h5 id="authorization-code-flow-with-proof-key-for-code-exchange-pkce">Authorization Code Flow with Proof Key for Code Exchange (PKCE)</h5>
<ul>
<li><strong>Public Clients</strong> (Native and Single-Page Applications).</li>
</ul>
<figure>
<img src="https://hais-note-pics-1301462215.cos.ap-chengdu.myqcloud.com/auth-sequence-auth-code-pkce.png" alt="Authorization Code Flow with PKCE" /><figcaption aria-hidden="true">Authorization Code Flow with PKCE</figcaption>
</figure>
<p>In short:</p>
<ol type="1">
<li>There is no <strong>Client ID</strong> and <strong>Client Secret</strong> stored in the app.</li>
<li>The <strong>app</strong> generates cryptographically-random <strong>Code Verifier</strong>, and from this generates <strong>Code Challenge</strong>.</li>
<li><strong>Authorization Server</strong> stores <strong>Code Chanllenge</strong> and issue <strong>Authorization Code</strong> like normal Authorization Code Flow.</li>
<li>The <strong>app</strong> send the <strong>Authorization Code</strong> and <strong>Code Verifier</strong> to <strong>Authorization Server</strong>, where the <strong>Code Verifier</strong> and <strong>Code Challenge</strong> will be validated.</li>
</ol>
<h5 id="implicit-flow-with-form-post">Implicit Flow with Form Post</h5>
<ul>
<li>No <strong>Access Token</strong> (like JWT, to access some API), only ID Token (just for the client itself).</li>
<li>For front-end centered applications (maybe there are no backend)</li>
<li>Implicit Flow can also not be done with form post, it can also get token through redirected fragment.</li>
</ul>
<figure>
<img src="https://hais-note-pics-1301462215.cos.ap-chengdu.myqcloud.com/auth-sequence-implicit-form-post.png" alt="Implicit Flow with Form Post" /><figcaption aria-hidden="true">Implicit Flow with Form Post</figcaption>
</figure>
<h5 id="device-authorization-flow">Device Authorization Flow</h5>
<ul>
<li>Input-constrained devices asks the user to go to a link on their computer or smartphone and authorize the device.</li>
</ul>
<figure>
<img src="https://hais-note-pics-1301462215.cos.ap-chengdu.myqcloud.com/auth-sequence-device-auth.png" alt="Device Authorization Flow" /><figcaption aria-hidden="true">Device Authorization Flow</figcaption>
</figure>
<h4 id="endpoints">Endpoints</h4>
<h5 id="authorization-endpoint">Authorization Endpoint</h5>
<blockquote>
<p><code>/authorize</code></p>
</blockquote>
<ul>
<li>Interact with <strong>resource owner</strong> and <strong>get the authorization</strong> to access the protected resource.</li>
<li>E.g. 3rd party app uses Google Account to login.
<ul>
<li>First, the app will redirect to Google to <strong>authenticate</strong>.</li>
<li>Then you will get a consent screen, where you asked to <strong>authorize</strong> the app to access some of your data (email address and contacts, etc.).</li>
</ul></li>
</ul>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>response_type</code></td>
<td style="text-align: left;">Tells the authorization server which grant to execute.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>response_mode</code></td>
<td style="text-align: left;">(Optional) How the result of the authorization request is formatted. Values:<br />- <code>query</code>: for Authorization Code grant. <code>302 Found</code> triggers redirect.<br />- <code>fragment</code>: for Implicit grant. <code>302 Found</code> triggers redirect.<br />- <code>form_post</code>: <code>200 OK</code> with response parameters embedded in an HTML form as hidden parameters.<br />- <code>web_message</code>: For Silent Authentication. Uses HTML5 web messaging.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>client_id</code></td>
<td style="text-align: left;">The ID of the application that asks for authorization.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>redirect_uri</code></td>
<td style="text-align: left;">Holds a URL. A successful response from this endpoint results in a redirect to this URL.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>scope</code></td>
<td style="text-align: left;">A space-delimited list of permissions that the application requires.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>state</code></td>
<td style="text-align: left;">An opaque value, used for security purposes. If this request parameter is set in the request, then it is returned to the application as part of the <code>redirect_uri</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>connection</code></td>
<td style="text-align: left;">Specifies the connection type for Passwordless connections</td>
</tr>
</tbody>
</table>
<h5 id="token-endpoint">Token Endpoint</h5>
<blockquote>
<p><code>/oauth/token</code></p>
</blockquote>
<ul>
<li>Used by the <strong>application</strong> to get an <strong>Access Token</strong> or a <strong>Refresh Token</strong>.</li>
<li><strong>Implicit Flow</strong>: not used. Because an access token is issued directly through authorization endpoint.</li>
<li><strong>Authorization Code Flow</strong>: The app exchanges <strong>authorization code</strong> for access token.</li>
<li><strong>Client Credentials Flow, Resource Owner Password Flow</strong>: The app authenticates using a set of credentials and get an access token.</li>
</ul>
<h4 id="state-parameters">State Parameters</h4>
<ul>
<li>Allows you to restore the previous state of your application.</li>
<li>To mitigate CSRF attacks.</li>
</ul>
<h3 id="open-id-connect-oidc-protocol">Open ID Connect (OIDC) Protocol</h3>
<ul>
<li><p>A simple identity layer that sits on the top of OAuth 2.0.</p>
<ul>
<li><p>While OAuth 2.0 is about resource access and sharing, OIDC is about user authentication.</p></li>
<li><p>OIDC makes it easy to verify a user's identity and obtain basic profile information from the identity provider.</p></li>
</ul></li>
<li><p>Uses <strong>JSON Web Tokens (JWTs)</strong>.</p>
<ul>
<li>JWTs contain <strong>claims</strong> (statements, such as name or email address) about an entity and additional metadata.</li>
<li>OpenID Connect Specification defines a set of standard claims, including name, email, gender, and so on.</li>
<li>You can also create custom claims and add them to your tokens.</li>
</ul></li>
</ul>
<h3 id="security-assertion-markup-language-saml">Security Assertion Markup Language (SAML)</h3>
<p>SAML is an open-standard, XML-based data format for authentication and authorization between two entities without a password:</p>
<ul>
<li><strong>Service Provider</strong> (SP): Agrees to trust the identity provider to authenticate users.</li>
<li><strong>Identity Provider</strong> (IP): Authenticates users and provides to SP an authentication assertion that indicates a user has been authenticated.</li>
</ul>
<h3 id="web-services-federation-ws-fed">Web Services Federation (WS-Fed)</h3>
<p>Developed by Microsoft. It defines the way security tokens can be transported between different entities to exchange identity and authorization information.</p>
<h2 id="tokens">Tokens</h2>
<h3 id="json-web-tokens-jwts">JSON Web Tokens (JWTs)</h3>
<ul>
<li>JSON Web Token (JWT), pronounced "jot", is an open standard that defines a compact and self-contained way for securely transmitting information between parties as a JSON object.</li>
<li>JWT is digital signed, and can also be encrypted.</li>
</ul>
<h4 id="introduction">Introduction</h4>
<h5 id="benefits">Benefits</h5>
<blockquote>
<p>Compared to <strong>Simple Web Tokens (SWTs)</strong> and <strong>Security Assertion Markup Language (SAML)</strong> tokens.</p>
</blockquote>
<ul>
<li><strong>More compact</strong>: It is smaller than SAML token.</li>
<li><strong>More secure</strong>
<ul>
<li>Can use public/private key pair in the form of an X.509 certificate for signing. (In comparison, signing XML with XML Digital Signature without introducing obscure security holes is very difficult.)</li>
<li>Can be symmetrically signed by a shared secret using the HMAC algorithm.</li>
</ul></li>
<li><strong>More common</strong>: JSON parsers are common than XML parsers in most programming languages.</li>
<li><strong>Easier to process</strong>: JWT is used at internet scale. And can be sent through a RUL, through a POST parameter, or inside an HTTP header, and it is transmitted quickly.</li>
</ul>
<h5 id="use">Use</h5>
<ul>
<li><strong>Authentication</strong>: According to the OpenID Connect (OIDC) specs, an <strong>ID Token</strong> is always a JWT.</li>
<li><strong>Authorization</strong>: An <strong>Access Token</strong> may be a JWT. Single Sign-on (SSO) widely uses JWT.</li>
<li><strong>Information Exchange</strong></li>
</ul>
<h4 id="structure">Structure</h4>
<p>All Auth0-issued JWTs have <strong>JSON Web Signatures (JWTs)</strong>, meaning they are <strong>signed</strong> rather than <strong>encrypted</strong>.</p>
<ul>
<li>A JWS represents content secured with digital signatures or Message Authentication Codes (MACs) using JSON-based structures.</li>
</ul>
<p>A well-formed JWT consists of three concatenated Base64url-encoded strings, separated by dots (<code>.</code>):</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">JOSE Header.JWS Payload.JWS Signatrue

eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><a target="_blank" rel="noopener" href="https://jwt.io/?_gl=1*36goab*rollup_ga*MTE1MjA5ODQwOC4xNjc3MDQ2ODg4*rollup_ga_F1G3E656YZ*MTY3NzM5NjU5Ni4xMi4xLjE2NzczOTg2NzUuNC4wLjA.&amp;_ga=2.71229206.781441431.1677243082-1152098408.1677046888">JWT.io Debugger</a> allows you to quickly check that a JWT is well formed and to manually inspect the values of the various claims.</p>
<h5 id="jose-header">JOSE Header</h5>
<p>JOSE (JSON Object Signing and Encryption) Header is comprised of:</p>
<ul>
<li><code>alg</code>: The hashing algorithm being used (e.g., HMAC SHA256 or RSA).</li>
<li><code>typ</code>: The type of the JWT.</li>
</ul>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"alg"</span><span class="token operator">:</span> <span class="token string">"HS256"</span><span class="token punctuation">,</span>
  <span class="token property">"typ"</span><span class="token operator">:</span> <span class="token string">"JWT"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="jws-payload">JWS Payload</h5>
<p>The payload contains statements about the entity, and additional entity attributes, which are called claims.</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"sub"</span><span class="token operator">:</span> <span class="token string">"123456789"</span><span class="token punctuation">,</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"John Doe"</span><span class="token punctuation">,</span>
  <span class="token property">"admin"</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="jws-signature">JWS Signature</h5>
<p>Is used to <strong>verify that the sender</strong> of the JWT is who it says, and <strong>ensure that the message wasn't changed</strong> along the way.</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  secret)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="claims">Claims</h4>
<p>JWT claims are pieces information asserted about a subject.</p>
<p>E.g. The following JSON object contains three claims (<code>sub</code>, <code>name</code>, <code>admin</code>):</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"sub"</span><span class="token operator">:</span> <span class="token string">"123456789"</span><span class="token punctuation">,</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"John Doe"</span><span class="token punctuation">,</span>
  <span class="token property">"admin"</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>There are 2 types of JWT claims:</p>
<ul>
<li><strong>Registered</strong>: Standard claims registered with the <a target="_blank" rel="noopener" href="https://www.iana.org/assignments/jwt/jwt.xhtml">IANA</a> and defined by the <a target="_blank" rel="noopener" href="https://www.rfc-editor.org/rfc/rfc7519">JWT Specification</a>.</li>
<li><strong>Custom</strong>: Consists of non-registered public or private claims. Public claims are collision-resistant while private claims are subject to possible collisions.</li>
</ul>
<h5 id="registered-claims">Registered Claims</h5>
<ul>
<li><code>iss</code> (issuer): Issuer of the JWT</li>
<li><code>sub</code> (subject): Subject of the JWT (the user)</li>
<li><code>aud</code> (audience): Recipient for which the JWT is intended</li>
<li><code>exp</code> (expiration time): Time after which the JWT expires</li>
<li><code>nbf</code> (not before time): Time before which the JWT must not be accepted for processing</li>
<li><code>iat</code> (issued at time): Time at which the JWT was issued; can be used to determine age of the JWT</li>
<li><code>jti</code> (JWT ID): Unique identifier; can be used to prevent the JWT from being replayed (allows a token to be used only once)</li>
</ul>
<h5 id="custom-claims">Custom Claims</h5>
<h6 id="public-claims">Public Claims</h6>
<p>If you create public claims, you must either register them or use collision-resistant names through namespacing and take reasonable precautions to make sure you are in control of the namespace you use.</p>
<p>In the <a target="_blank" rel="noopener" href="https://www.iana.org/assignments/jwt/jwt.xhtml#claims">IANA JSON Web Token Claims Registry</a>, you can see some examples of public claims registered by OpenID Connect:</p>
<ul>
<li><code>auth_time</code></li>
<li><code>acr</code></li>
<li><code>nonce</code></li>
</ul>
<h6 id="private-claims">Private Claims</h6>
<p>You can create private custom claims to share information specific to your application.</p>
<h4 id="signing-algorithms">Signing Algorithms</h4>
<ul>
<li><strong>RS256</strong> (RSA Signature with SHA-256): An asymmetric algorithm.</li>
<li><strong>HS256</strong> (HMAC with SHA-256): A symmetric algorithm.</li>
</ul>
<p>RS256 is recommended, because:</p>
<ul>
<li>Only the holder of private key can sign tokens, while anyone can check if the token is valid using the public key.</li>
<li>Can request a token that is valid for multiple audiences.</li>
<li>If the private key is compromised, you can implement key rotation without having to re-deploy your application or API with the new secret. (Which you have to do if using HS256)</li>
</ul>
<h3 id="id-tokens">ID Tokens</h3>
<ul>
<li>Cache user profile information and provide it to a client application.</li>
<li>The application receives an ID token after a user successfully authenticates, then consumes the ID token and extracts user information from it.</li>
<li><strong>ID Token should never be used to obtain direct access to APIs to make authorization decisions.</strong></li>
<li>By default, an ID token is valid for 10 hours.</li>
</ul>
<h4 id="validate-id-tokens">Validate ID Tokens</h4>
<ol type="1">
<li>Validate the JWT.</li>
<li>Check additional standard claims, including:
<ol type="1">
<li><strong>Token audience</strong> (<code>aud</code>, string): The audience value for the token must match the client ID of the application.</li>
<li><strong>Nonce</strong> (<code>nonce</code>, string): Passing a nonce in the token request is recommended (required for the Implicit Flow) to help prevent replay attacks. The nonce value in the token must exactly match the original nonce sent in the request.</li>
</ol></li>
</ol>
<h3 id="access-tokens">Access Tokens</h3>
<ul>
<li>Allow an application to access an API.</li>
<li>If you have chosen to allow users to login through an <strong>Identity Provider (IdP)</strong>, such as Facebook, the IdP will issue its own access token to allow your application to call the IDP's API.</li>
</ul>
<h4 id="validate-access-tokens">Validate Access Tokens</h4>
<p>An Access Token is meant for an API and should be validated only by the API for which it was intended.</p>
<p>If any of these checks fail, the token is considered invalid, and the request must be rejected with <code>401 Unauthorized</code> result.</p>
<ol type="1">
<li><p>Validate the JWT.</p></li>
<li><p>Verify token audience claims. The <code>aud</code> filed could contain both an audience corresponding to your custom API and an audience corresponding to the <code>/userinfo</code> endpoint.</p></li>
<li><p>Verify permissions (scopes). Check the <code>scope</code> claim. It should match the permissions required for the endpoint being accessed. E.g.</p>
<ul>
<li><p><code>create:users</code> provides access to the <code>/create</code> endpoint</p></li>
<li><p><code>read:users</code> provides access to the <code>/read</code> endpoint</p></li>
</ul></li>
</ol>
<h3 id="refresh-tokens">Refresh Tokens</h3>
<ul>
<li>An <strong>OAuth Refresh Token</strong> is a credential artifact that OAuth can use to get a new Access Token without user interaction.</li>
<li>This allows the Authorization Server to shorten the access token lifetime. You can request new access tokens until the refresh token is on the DenyList.</li>
<li><strong>It is important to keep the number of refresh tokens within a reasonable manageable limit.</strong> Applications must store refresh tokens securely because they essentially allow a user to remain authenticated forever.</li>
</ul>
<h3 id="token-best-practices">Token Best Practices</h3>
<h4 id="basics-to-keep-in-mind">Basics to Keep in Mind</h4>
<ul>
<li><strong>Keep it secret. Keep it safe.</strong> The signing key should be treated like any other credential and revealed only to services that need it.</li>
<li><strong>Do not add sensitive data to the payload.</strong> Tokens are signed to protect against manipulation and are easily decoded.</li>
<li><strong>Give tokens an expiration.</strong></li>
<li><strong>Embrace HTTPS.</strong> Do not send tokens over non-HTTPS connections as those requests can be intercepted and tokens compromised.</li>
<li><strong>Consider all of your authorization use cases.</strong></li>
<li><strong>Store and reuse.</strong></li>
</ul>
<h1 id="auth0">Auth0</h1>
<h2 id="authenticate">Authenticate</h2>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/hais-notebook/2023/02/09/Java/" rel="prev" title="Java">
                  <i class="fa fa-chevron-left"></i> Java
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/hais-notebook/2023/03/08/Container/" rel="next" title="Containers">
                  Containers <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Harvey Zhang</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="/hais-notebook/lib/animejs/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/hais-notebook/js/comments.js"></script><script src="/hais-notebook/js/utils.js"></script><script src="/hais-notebook/js/next-boot.js"></script>

  <script src="/hais-notebook/lib/hexo-generator-searchdb/dist/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/hais-notebook/js/third-party/search/local-search.js"></script>





  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"/hais-notebook/lib/mathjax/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/hais-notebook/js/third-party/math/mathjax.js"></script>



</body>
</html>
